using System.Collections;using System.Collections.Generic;using UnityEngine;using USocket.Messages;using UnityEngine.EventSystems;using UnityEngine.UI;public class TP_StartGame{    GameObject root_;    GameObject room_;    GameObject desk_;    int level;    int currentPlayerNumber;    int currentRound;    int totalRound;    byte currentPosition;    GameObject sitdownBtn;    GameObject waitBtn;    bool issitdown;    public TP_StartGame(GameObject root, GameObject room)    {        root_ = root;        room_ = room;        desk_ = GameObject.Find("Game_Model");        currentPosition = 1;        waitBtn = root_.transform.Find("Middle").Find("Bottom").            Find("Button_group").Find("Button_Dengdai").gameObject;        issitdown = true;    }    void InitUIEvents()    {        sitdownBtn = root_.transform.Find("Middle").Find("Bottom").            Find("Button_group").Find("Button_sit").gameObject;        XPointEvent.AutoAddListener(sitdownBtn, OnSitDown, null);    }    void OnSitDown(EventTriggerType eventtype, object button, PointerEventData eventData)    {        if (eventtype == EventTriggerType.PointerUp)        {            TexasPokerTypeInfo typeinfo = (TexasPokerTypeInfo)button;            UMessage sitdown = new UMessage((uint)GameCity.EMSG_ENUM.CCMsg_TEXASPOKER_CM_APPLYSITORSTAND);            sitdown.Add(GameMain.hall_.GetPlayerId());            if (issitdown)                sitdown.Add((byte)1);            else                sitdown.Add((byte)2);            sitdown.Add(currentPosition);            if (HallMain.gametcpclient.IsSocketConnected)            {                HallMain.SendMsgToRoomSer(sitdown);            }        }    }    void InitBackMsg()    {        CMsgDispatcher.GetInstance().RegMsgDictionary(                (uint)GameCity.EMSG_ENUM.CCMsg_TEXASPOKER_CM_APPLYSITORSTAND, BackSitdown);    }    bool BackSitdown(uint _msgType, UMessage msg)    {        sitdownBtn.SetActive(true);        Text sitText = sitdownBtn.transform.Find("Text").gameObject.GetComponent<Text>();        if (issitdown)        {            AddPlayerByPosition(0);            sitText.text = "站起";        }        else        {                        sitText.text = "坐下";        }                    ClientSitDown();        return true;    }    void ClientSitDown()    {    }    void RefreshPlayers()    {        GameObject playerinfoBG = root_.transform.Find("Middle").Find("PlayerInfor").gameObject;        for (byte index = 1; index < 8; index++)        {            GameObject playerinfo = playerinfoBG.transform.Find("Icon_PlayerInfor_" + index.ToString() ).gameObject;            Image playerHeadImg = playerinfo.transform.Find("PlayerBG").                    Find("Head").Find("HeadMask").Find("ImageHead").gameObject.GetComponent<Image>();            Text playerName = playerinfo.transform.Find("PlayerBG").                    Find("ImageBG").Find("TextName").gameObject.GetComponent<Text>();            Text playerCoin = playerinfo.transform.Find("PlayerBG").                    Find("Image_coinframe").Find("Text_Coin").gameObject.GetComponent<Text>();            if (TP_DataCenter.Instance().tper.playerinfos.ContainsKey(index))            {                playerHeadImg.sprite = GameMain.hall_.GetIcon(TP_DataCenter.Instance().tper.playerinfos[index].url,                    TP_DataCenter.Instance().tper.playerinfos[index].userid, (int)TP_DataCenter.Instance().tper.playerinfos[index].faceid);                playerName.text = TP_DataCenter.Instance().tper.playerinfos[index].playerName;                playerCoin.text = TP_DataCenter.Instance().tper.playerinfos[index].carryMoney.ToString();            }            else            {                playerHeadImg.sprite = null;                playerName.text = "";                playerCoin.text = "";            }        }    }    void AddPlayerByPosition(byte position)    {        GameObject playerinfoBG = root_.transform.Find("Middle").Find("PlayerInfor").gameObject;        GameObject playerinfo = playerinfoBG.transform.Find("Icon_PlayerInfor_" + position.ToString()).gameObject;        Image playerHeadImg = playerinfo.transform.Find("PlayerBG").                Find("Head").Find("HeadMask").Find("ImageHead").gameObject.GetComponent<Image>();        Text playerName = playerinfo.transform.Find("PlayerBG").                Find("ImageBG").Find("TextName").gameObject.GetComponent<Text>();        Text playerCoin = playerinfo.transform.Find("PlayerBG").                Find("Image_coinframe").Find("Text_Coin").gameObject.GetComponent<Text>();        if (TP_DataCenter.Instance().tper.playerinfos.ContainsKey(position))            return;        TP_DataCenter.Instance().tper.playerinfos[position] = new TexasPokerPlayerInfo();        TP_DataCenter.Instance().tper.playerinfos[position].sitNo = 0;        TP_DataCenter.Instance().tper.playerinfos[position].userid = 0;        TP_DataCenter.Instance().tper.playerinfos[position].faceid = 0;        TP_DataCenter.Instance().tper.playerinfos[position].carryMoney = 0;        TP_DataCenter.Instance().tper.playerinfos[position].playerName = "";        TP_DataCenter.Instance().tper.playerinfos[position].currentCardNum = 0;        TP_DataCenter.Instance().tper.playerinfos[position].preChipNum = 0;        TP_DataCenter.Instance().tper.playerinfos[position].currChipNum = 0;        playerHeadImg.sprite = GameMain.hall_.GetIcon(TP_DataCenter.Instance().tper.playerinfos[position].url,             TP_DataCenter.Instance().tper.playerinfos[position].userid, (int)TP_DataCenter.Instance().tper.playerinfos[position].faceid);        playerName.text = TP_DataCenter.Instance().tper.playerinfos[position].playerName;        playerCoin.text = TP_DataCenter.Instance().tper.playerinfos[position].carryMoney.ToString();    }    void RemovePlayerByPosition(byte position)    {        GameObject playerinfoBG = root_.transform.Find("Middle").Find("PlayerInfor").gameObject;        GameObject playerinfo = playerinfoBG.transform.Find("Icon_PlayerInfor_" + position.ToString()).gameObject;        Image playerHeadImg = playerinfo.transform.Find("PlayerBG").                Find("Head").Find("HeadMask").Find("ImageHead").gameObject.GetComponent<Image>();        Text playerName = playerinfo.transform.Find("PlayerBG").                Find("ImageBG").Find("TextName").gameObject.GetComponent<Text>();        Text playerCoin = playerinfo.transform.Find("PlayerBG").                Find("Image_coinframe").Find("Text_Coin").gameObject.GetComponent<Text>();        if (TP_DataCenter.Instance().tper.playerinfos.ContainsKey(position))        {            TP_DataCenter.Instance().tper.playerinfos.Remove(position);            playerHeadImg.sprite = null;            playerName.text = "";            playerCoin.text = "";        }    }    void RefreshDeskTitle()    {        TextMesh tm = desk_.transform.Find("ZhuoZi").Find("Zhuomian").Find("3DText_rule").gameObject.GetComponent<TextMesh>();        string levelname = "";        switch (level)        {            case 1:                levelname = "白手起家";                break;            case 2:                levelname = "中产阶级";                break;            case 3:                levelname = "德州大亨";                break;        }        tm.text = levelname + "(" + currentPlayerNumber.ToString() + "人):" + currentRound.ToString() + "/" + totalRound.ToString() + "牌 限注(" + "倍底池)";    }    void RefreshChipPanel()    {        GameObject chipPanel = desk_.transform.Find("ZhuoZi").Find("Zhuomian").Find("Points_Pingmu").gameObject;        for(int index = 1; index < 7; index++)        {            TextMesh bianzhu = chipPanel.transform.Find("3DText_Chip_bian" + index.ToString()).gameObject.GetComponent<TextMesh>();            bianzhu.text = "边" + index.ToString() + ":";        }    }    void AddPokerToPosition( TP_Pokers poker, uint position )    {    }    void AddChipToPosition()    {    }}